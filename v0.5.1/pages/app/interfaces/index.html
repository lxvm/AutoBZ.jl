<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Interfaces · AutoBZ.jl</title><meta name="title" content="Interfaces · AutoBZ.jl"/><meta property="og:title" content="Interfaces · AutoBZ.jl"/><meta property="twitter:title" content="Interfaces · AutoBZ.jl"/><meta name="description" content="Documentation for AutoBZ.jl."/><meta property="og:description" content="Documentation for AutoBZ.jl."/><meta property="twitter:description" content="Documentation for AutoBZ.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">AutoBZ.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../workflow/">Getting started</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../demo/dos/">Density of states</a></li><li><a class="tocitem" href="../../demo/density/">Electron density</a></li><li><a class="tocitem" href="../../demo/oc/">Optical conductivity</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../man/fourier/">Fourier series</a></li><li><a class="tocitem" href="../self_energy/">Self energies</a></li><li><a class="tocitem" href="../integrands/">Integrands</a></li><li class="is-active"><a class="tocitem" href>Interfaces</a><ul class="internal"><li><a class="tocitem" href="#Wannier90"><span>Wannier90</span></a></li><li><a class="tocitem" href="#Python"><span>Python</span></a></li><li><a class="tocitem" href="#MATLAB"><span>MATLAB</span></a></li></ul></li><li><a class="tocitem" href="../../man/internal/">Internal</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Interfaces</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Interfaces</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/lxvm/AutoBZ.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/lxvm/AutoBZ.jl/blob/main/docs/src/pages/app/interfaces.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Interfaces"><a class="docs-heading-anchor" href="#Interfaces">Interfaces</a><a id="Interfaces-1"></a><a class="docs-heading-anchor-permalink" href="#Interfaces" title="Permalink"></a></h1><h2 id="Wannier90"><a class="docs-heading-anchor" href="#Wannier90">Wannier90</a><a id="Wannier90-1"></a><a class="docs-heading-anchor-permalink" href="#Wannier90" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.load_wannier90_data" href="#AutoBZ.load_wannier90_data"><code>AutoBZ.load_wannier90_data</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">load_wannier90_data(seedname::String; bz::AbstractBZ=FBZ(), interp::AbstractWannierInterp=HamiltonianInterp, kwargs...)</code></pre><p>Return a tuple <code>(interp, bz)</code> containing the requested Wannier interpolant, <code>interp</code> and the Brillouin zone <code>bz</code> to integrate over. The <code>seedname</code> should point to Wannier90 data to read in. Additional keywords are passed to the interpolant constructor, <a href="#AutoBZ.load_interp"><code>load_interp</code></a>, while <a href="#AutoBZ.load_autobz"><code>load_autobz</code></a> can be referenced for Brillouin zone details. For a list of possible keywords, see <code>subtypes(AbstractBZ)</code> and <code>using TypeTree; tt(AbstractWannierInterp)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/67bcdb1ccf9df5e9730dc53fcb9c6b37357aa3ee/src/wannier90io.jl#L382-L391">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.load_interp" href="#AutoBZ.load_interp"><code>AutoBZ.load_interp</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">load_interp(::Type{&lt;:HamiltonianInterp}, seed;
    gauge=Wannier(), soc=nothing,
    compact=:N, precision=Float64, droptol=eps(precision))</code></pre><p>Load Hamiltonian coefficients from Wannier90 output <code>&quot;seed_hr.dat&quot;</code> into an <a href="../../man/fourier/#AutoBZ.AbstractHamiltonianInterp"><code>AbstractHamiltonianInterp</code></a> that interpolates <code>h</code> with unit period. The <code>gauge</code> keyword can be <a href="../../man/fourier/#AutoBZ.Wannier"><code>Wannier</code></a> or <a href="../../man/fourier/#AutoBZ.Hamiltonian"><code>Hamiltonian</code></a> to set whether the coefficients are interpolated in the orbital basis, i.e. as is, or rotated into the band basis, i.e. the Hamiltonian eigenbasis. Additionally, the <code>soc</code> keyword can specify a <code>SMatrix</code> (from StaticArrays.jl) of twice the size of the coefficients in the <code>seed</code> file that is added to the Hamiltonian in orbital basis. For more details see <a href="../../man/fourier/#AutoBZ.SOCMatrix"><code>SOCMatrix</code></a>.</p><p>There are also several keywords to control the memory usage of the array: <code>compact</code> which may indicate the coefficient matrices are Hermitian, <code>precision</code> which sets the floating-point precision of the array, and <code>droptol</code> which skips coefficients under the given relative tolerance. Possible values of <code>compact</code> are:</p><ul><li><code>:N</code>: do not store the coefficients in compact form</li><li><code>:L</code>: store the lower triangle of the coefficients</li><li><code>:U</code>: store the upper triangle of the coefficients</li><li><code>:S</code>: store the lower triangle of the symmetrized coefficients, <code>(c+c&#39;)/2</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/67bcdb1ccf9df5e9730dc53fcb9c6b37357aa3ee/src/wannier90io.jl#L37-L59">source</a></section><section><div><pre><code class="language-julia hljs">load_interp(::Type{&lt;:BerryConnectionInterp}, seed;
    coord=Lattice(), soc=nothing,
    precision=Float64, compact=:N, droptol=eps(precision))</code></pre><p>Load position operator coefficients from Wannier90 output <code>&quot;seed_r.dat&quot;</code> into a <a href="../../man/fourier/#AutoBZ.BerryConnectionInterp"><code>BerryConnectionInterp</code></a> that interpolates <code>(A1, A2, A3)</code>. Specify <code>coord</code> as <a href="../../man/fourier/#AutoBZ.Lattice"><code>Lattice</code></a> or <a href="../../man/fourier/#AutoBZ.Cartesian"><code>Cartesian</code></a> to have the position operator interpolated in those coordinates.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/67bcdb1ccf9df5e9730dc53fcb9c6b37357aa3ee/src/wannier90io.jl#L175-L184">source</a></section><section><div><pre><code class="language-julia hljs">load_interp(::Type{&lt;:GradientVelocityInterp}, seed, A;
    gauge=Wannier(), vcomp=Whole(), coord=Lattice(), soc=nothing,
    precision=Float64, compact=:N, droptol=eps(precision))</code></pre><p>Load coefficients for a Hamiltonian and its derivatives from Wannier90 output <code>&quot;seed_hr.dat&quot;</code> into a <a href="../../man/fourier/#AutoBZ.GradientVelocityInterp"><code>GradientVelocityInterp</code></a> that interpolates <code>(h, v)</code>. Specify <code>vcomp</code> as <a href="../../man/fourier/#AutoBZ.Whole"><code>Whole</code></a>, <a href="../../man/fourier/#AutoBZ.Intra"><code>Intra</code></a>, or <a href="../../man/fourier/#AutoBZ.Inter"><code>Inter</code></a> to use certain transitions. Note these velocities are not gauge-covariant.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/67bcdb1ccf9df5e9730dc53fcb9c6b37357aa3ee/src/wannier90io.jl#L202-L211">source</a></section><section><div><pre><code class="language-julia hljs">load_interp(::Type{&lt;:CovariantVelocityInterp}, seed, A;
    gauge=Wannier(), vcomp=whole(), coord=Lattice(), soc=nothing,
    precision=Float64, compact=:N, droptol=eps(precision))</code></pre><p>Load coefficients for a Hamiltonian and its derivatives from Wannier90 output <code>&quot;seed_hr.dat&quot;</code> and <code>&quot;seed_r.dat&quot;</code> into a <a href="../../man/fourier/#AutoBZ.CovariantVelocityInterp"><code>CovariantVelocityInterp</code></a> that interpolates <code>(h, v)</code>. Specify <code>vcomp</code> as <a href="../../man/fourier/#AutoBZ.Whole"><code>Whole</code></a>, <a href="../../man/fourier/#AutoBZ.Intra"><code>Intra</code></a>, or <a href="../../man/fourier/#AutoBZ.Inter"><code>Inter</code></a> to use certain transitions. These velocities are gauge-covariant.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/67bcdb1ccf9df5e9730dc53fcb9c6b37357aa3ee/src/wannier90io.jl#L222-L231">source</a></section><section><div><pre><code class="language-julia hljs">load_interp(::Type{&lt;:MassVelocityInterp}, seed, A;
    gauge=Wannier(), vcomp=Whole(), coord=Lattice(), soc=nothing,
    precision=Float64, compact=:N, droptol=eps(precision))</code></pre><p>Load coefficients for a Hamiltonian and its derivatives from Wannier90 output <code>&quot;seed_hr.dat&quot;</code> into a <a href="../../man/fourier/#AutoBZ.MassVelocityInterp"><code>MassVelocityInterp</code></a> that interpolates <code>(h, v, μ)</code>. Specify <code>vcomp</code> as <a href="../../man/fourier/#AutoBZ.Whole"><code>Whole</code></a>, <a href="../../man/fourier/#AutoBZ.Intra"><code>Intra</code></a>, or <a href="../../man/fourier/#AutoBZ.Inter"><code>Inter</code></a> to use certain transitions. Note these operators are not gauge-covariant.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/67bcdb1ccf9df5e9730dc53fcb9c6b37357aa3ee/src/wannier90io.jl#L243-L252">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.load_autobz" href="#AutoBZ.load_autobz"><code>AutoBZ.load_autobz</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">load_autobz(::AbstractBZ, seedname; kws...)</code></pre><p>Automatically load a BZ using data from a &quot;seedname.wout&quot; file with the <code>load_bz</code> interface from AutoBZCore.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/67bcdb1ccf9df5e9730dc53fcb9c6b37357aa3ee/src/wannier90io.jl#L362-L367">source</a></section></article><h2 id="Python"><a class="docs-heading-anchor" href="#Python">Python</a><a id="Python-1"></a><a class="docs-heading-anchor-permalink" href="#Python" title="Permalink"></a></h2><p>Julia code, including <code>AutoBZ.jl</code>, can be called from Python using the package <a href="https://pyjulia.readthedocs.io">PyJulia</a></p><h3 id="Setup"><a class="docs-heading-anchor" href="#Setup">Setup</a><a id="Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Setup" title="Permalink"></a></h3><p>TL;DR</p><pre><code class="nohighlight hljs">$ julia -e &#39;import Pkg; Pkg.add(&quot;PyCall&quot;)&#39;
$ python3 -m pip install julia</code></pre><p>If you want to, you can install PyJulia in a Python venv, but on the Julia side PyCall.jl must be installed in the default environment</p><h3 id="Demo"><a class="docs-heading-anchor" href="#Demo">Demo</a><a id="Demo-1"></a><a class="docs-heading-anchor-permalink" href="#Demo" title="Permalink"></a></h3><p>The Python snippet below shows how from the <code>demos</code> folder of the AutoBZ repository you can run one of the demo scripts:</p><pre><code class="nohighlight hljs">from julia.api import Julia
jl = Julia(compiled_modules=False)

# julia environment setup in working directory &#39;demos&#39;
jl.eval(&quot;&quot;&quot;
import Pkg
Pkg.activate(&quot;.&quot;)
Pkg.instantiate()
&quot;&quot;&quot;)

# capture output of script
out = jl.eval(&#39;include(&quot;dos_test.jl&quot;)&#39;)</code></pre><p>The first two lines are adapted for loading PyJulia on Debian systems.</p><h2 id="MATLAB"><a class="docs-heading-anchor" href="#MATLAB">MATLAB</a><a id="MATLAB-1"></a><a class="docs-heading-anchor-permalink" href="#MATLAB" title="Permalink"></a></h2><p>Julia code, including <code>AutoBZ.jl</code>, can be called from MATLAB using the package <a href="https://github.com/jondeuce/MATDaemon.jl">MATDaemon.jl</a>.</p><h3 id="Setup-2"><a class="docs-heading-anchor" href="#Setup-2">Setup</a><a class="docs-heading-anchor-permalink" href="#Setup-2" title="Permalink"></a></h3><ol><li>Download the</li></ol><p><a href="https://github.com/jondeuce/MATDaemon.jl/raw/master/api/jlcall.m"><code>jlcall.m</code></a> script, which will install the Julia server when first called.</p><ol><li>Install <a href="https://julialang.org/">Julia</a> and give MATLAB the path the Julia binary by running <code>setenv(&#39;PATH&#39;,[&#39;path-to-julia/bin:&#39;,getenv(&#39;PATH&#39;)]);</code></li><li>Test that <code>jlcall</code> works by running <code>jlcall(&#39;sort&#39;, {rand(2,5)}, struct(&#39;dims&#39;, int64(2)))</code></li><li>Create setup.jl with the lines <code>import Pkg; Pkg.activate(&quot;.&quot;); Pkg.develop(path=expanduser(&quot;path-to-AutoBZ.jl&quot;));</code></li><li>Start a julia server within MATLAB with the appropriate modules: <code>jlcall(&#39;&#39;, &#39;project&#39;, &#39;path-to-myproject&#39;, &#39;setup&#39;, &#39;path-to-setup.jl&#39;, &#39;modules&#39;, {&#39;LinearAlgebra&#39;,&#39;AutoBZ&#39;}, &#39;threads&#39;, &#39;auto&#39;, &#39;restart&#39;, true);</code></li><li>Now AutoBZ can be used via <code>jlcall</code></li></ol><h3 id="Demo-2"><a class="docs-heading-anchor" href="#Demo-2">Demo</a><a class="docs-heading-anchor-permalink" href="#Demo-2" title="Permalink"></a></h3><p>Suppose we would like to run the function <code>get_dos</code> defined in this <code>script.jl</code></p><pre><code class="nohighlight hljs">import Pkg; Pkg.activate(&quot;.&quot;); Pkg.develop(path=expanduser(&quot;path-to-AutoBZ.jl&quot;))
using AutoBZ

function get_dos(seedname, self_energy_path, ωs, rtol, atol)
    H, FBZ = load_wannier90_data(seedname)
    Σ = load_self_energy(self_energy_path)
    integrand = DOSSolver(Σ, H, FBZ, IAI(); ω=first(ωs))
    solver = IntegralSolver(integrand, FBZ, abstol=atol, reltol=rtol)
    return map(ωs) do ω
        update_gloc!(solver; ω)
        solve!(solver).value
    end
end</code></pre><p>The MATLAB snippet below shows how to setup the Julia server to run a demo script.</p><pre><code class="nohighlight hljs">jlcall(&#39;&#39;, ...
    &#39;project&#39;, &#39;/path/to/MyProject&#39;, % use Julia environment with AutoBZ
    &#39;setup&#39;, &#39;/path/to/setup.jl&#39;, % path to script shown above
    &#39;modules&#39;, {&#39;AutoBZ&#39;}, % import AutoBZ and other modules
    &#39;threads&#39;, &#39;auto&#39;, % use the default number of Julia threads
    &#39;restart&#39;, true % start a fresh Julia server environment
)</code></pre><p>and the snippet below shows how to call <code>get_dos</code> from MATLAB</p><pre><code class="nohighlight hljs">jlcall(&#39;get_dos&#39;, &#39;.../svo&#39;, &#39;.../svo_self_energy.txt&#39;, {0.5})</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../integrands/">« Integrands</a><a class="docs-footer-nextpage" href="../../man/internal/">Internal »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Thursday 18 July 2024 15:40">Thursday 18 July 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
