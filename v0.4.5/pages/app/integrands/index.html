<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Integrands · AutoBZ.jl</title><meta name="title" content="Integrands · AutoBZ.jl"/><meta property="og:title" content="Integrands · AutoBZ.jl"/><meta property="twitter:title" content="Integrands · AutoBZ.jl"/><meta name="description" content="Documentation for AutoBZ.jl."/><meta property="og:description" content="Documentation for AutoBZ.jl."/><meta property="twitter:description" content="Documentation for AutoBZ.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">AutoBZ.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../man/fourier/">Fourier series</a></li><li><a class="tocitem" href="../self_energy/">Self energies</a></li><li class="is-active"><a class="tocitem" href>Integrands</a><ul class="internal"><li><a class="tocitem" href="#User-defined"><span>User-defined</span></a></li><li><a class="tocitem" href="#Pre-defined"><span>Pre-defined</span></a></li></ul></li><li><a class="tocitem" href="../interfaces/">Interfaces</a></li><li><a class="tocitem" href="../../man/internal/">Internal</a></li></ul></li><li><a class="tocitem" href="../../demo/">Demos</a></li><li><a class="tocitem" href="../../workflow/">Workflow</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Integrands</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Integrands</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/lxvm/AutoBZ.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/lxvm/AutoBZ.jl/blob/main/docs/src/pages/app/integrands.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Integrands"><a class="docs-heading-anchor" href="#Integrands">Integrands</a><a id="Integrands-1"></a><a class="docs-heading-anchor-permalink" href="#Integrands" title="Permalink"></a></h1><h2 id="User-defined"><a class="docs-heading-anchor" href="#User-defined">User-defined</a><a id="User-defined-1"></a><a class="docs-heading-anchor-permalink" href="#User-defined" title="Permalink"></a></h2><p>For integrands that can be evaluated by Wannier interpolation, the following data are necessary to define an integrand:</p><ul><li>the integrand evaluator</li><li>a Fourier series</li><li>additional parameters for the evaluator</li></ul><p>Consider implementing custom integrands using the generic template type <code>AutoBZCore.FourierIntegrand</code> that is compatible with all of the adaptive and equispace integration routines. Using this interface will automatically optimize multi-dimensional Fourier series evaluations with the various integration routines.</p><h2 id="Pre-defined"><a class="docs-heading-anchor" href="#Pre-defined">Pre-defined</a><a id="Pre-defined-1"></a><a class="docs-heading-anchor-permalink" href="#Pre-defined" title="Permalink"></a></h2><h3 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.GlocIntegrand" href="#AutoBZ.GlocIntegrand"><code>AutoBZ.GlocIntegrand</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">GlocIntegrand(h; Σ, ω, μ=0)</code></pre><p>Green&#39;s function integrands accepting a self energy Σ that can either be a matrix or a function of ω (see the self energy section of the documentation for examples)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/c1395c2eda11d0ef2851b003642910b6e3fc2126/src/apps.jl#L179-L184">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.DiagGlocIntegrand" href="#AutoBZ.DiagGlocIntegrand"><code>AutoBZ.DiagGlocIntegrand</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">DiagGlocIntegrand(h; Σ, ω, μ=0)</code></pre><p>Green&#39;s function integrands accepting a self energy Σ that can either be a matrix or a function of ω (see the self energy section of the documentation for examples)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/c1395c2eda11d0ef2851b003642910b6e3fc2126/src/apps.jl#L179-L184">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.TrGlocIntegrand" href="#AutoBZ.TrGlocIntegrand"><code>AutoBZ.TrGlocIntegrand</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">TrGlocIntegrand(h; Σ, ω, μ=0)</code></pre><p>Green&#39;s function integrands accepting a self energy Σ that can either be a matrix or a function of ω (see the self energy section of the documentation for examples)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/c1395c2eda11d0ef2851b003642910b6e3fc2126/src/apps.jl#L179-L184">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.DOSIntegrand" href="#AutoBZ.DOSIntegrand"><code>AutoBZ.DOSIntegrand</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">DOSIntegrand(h; Σ, ω, μ=0)</code></pre><p>Green&#39;s function integrands accepting a self energy Σ that can either be a matrix or a function of ω (see the self energy section of the documentation for examples)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/c1395c2eda11d0ef2851b003642910b6e3fc2126/src/apps.jl#L179-L184">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.TransportFunctionIntegrand" href="#AutoBZ.TransportFunctionIntegrand"><code>AutoBZ.TransportFunctionIntegrand</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">TransportFunctionIntegrand(hv; β, μ=0)</code></pre><p>Computes the following integral</p><p class="math-container">\[\D_{\alpha\beta} = \int_{\text{BZ}} dk \operatorname{Tr}[\nu_\alpha(k) A(k,\omega_1) \nu_\beta(k) A(k, \omega_2)]\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/c1395c2eda11d0ef2851b003642910b6e3fc2126/src/apps.jl#L273-L280">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.TransportDistributionIntegrand" href="#AutoBZ.TransportDistributionIntegrand"><code>AutoBZ.TransportDistributionIntegrand</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">TransportDistributionIntegrand(hv; Σ, ω₁, ω₂, μ=0)</code></pre><p>A function whose integral over the BZ gives the transport distribution</p><p class="math-container">\[\Gamma_{\alpha\beta}(\omega_1, \omega_2) = \int_{\text{BZ}} dk \operatorname{Tr}[\nu_\alpha(k) A(k,\omega_1) \nu_\beta(k) A(k, \omega_2)]\]</p><p>Based on <a href="https://triqs.github.io/dft_tools/latest/guide/transport.html">TRIQS</a>. See <code>Integrand</code> for more details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/c1395c2eda11d0ef2851b003642910b6e3fc2126/src/apps.jl#L360-L369">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.KineticCoefficientIntegrand" href="#AutoBZ.KineticCoefficientIntegrand"><code>AutoBZ.KineticCoefficientIntegrand</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">KineticCoefficientIntegrand(bz, alg::AutoBZAlgorithm, hv::AbstracVelocity; Σ, n, β, Ω, μ=0, abstol, reltol, maxiters)
KineticCoefficientIntegrand(lb, ub, alg, hv::AbstracVelocity; Σ, n, β, Ω, μ=0, abstol, reltol, maxiters)</code></pre><p>A function whose integral over the BZ gives the kinetic coefficient. Mathematically, this computes</p><p class="math-container">\[A_{n,\alpha\beta}(\Omega) = \int_{-\infty}^{\infty} d \omega (\beta\omega)^{n} \frac{f(\omega) - f(\omega+\Omega)}{\Omega} \Gamma_{\alpha\beta}(\omega, \omega+\Omega)\]</p><p>where <span>$f(\omega) = (e^{\beta\omega}+1)^{-1}$</span> is the Fermi distriubtion. Based on <a href="https://triqs.github.io/dft_tools/latest/guide/transport.html">TRIQS</a>. The argument <code>alg</code> determines what the order of integration is. Given a BZ algorithm, the inner integral is the BZ integral. Otherwise it is the frequency integral.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/c1395c2eda11d0ef2851b003642910b6e3fc2126/src/apps.jl#L418-L432">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.OpticalConductivityIntegrand" href="#AutoBZ.OpticalConductivityIntegrand"><code>AutoBZ.OpticalConductivityIntegrand</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">OpticalConductivityIntegrand</code></pre><p>Returns a <code>KineticCoefficientIntegrand</code> with <code>n=0</code>. See <a href="#AutoBZ.KineticCoefficientIntegrand"><code>KineticCoefficientIntegrand</code></a> for further details</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/c1395c2eda11d0ef2851b003642910b6e3fc2126/src/apps.jl#L584-L589">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.ElectronDensityIntegrand" href="#AutoBZ.ElectronDensityIntegrand"><code>AutoBZ.ElectronDensityIntegrand</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ElectronDensityIntegrand(bz, alg::AutoBZAlgorithm, h::AbstractHamiltonianInterp; Σ, β, [μ=0])
ElectronDensityIntegrand(lb, ub, alg, h::AbstractHamiltonianInterp; Σ, β, [μ=0])</code></pre><p>A function whose integral over the BZ gives the electron density. Mathematically, this computes</p><p class="math-container">\[n(\mu) = \int_{-\infty}^{\infty} d \omega f(\omega) \operatorname{DOS}(\omega+\mu)\]</p><p>where <span>$f(\omega) = (e^{\beta\omega}+1)^{-1}$</span> is the Fermi distriubtion. The argument <code>alg</code> determines what the order of integration is. Given a BZ algorithm, the inner integral is the BZ integral. Otherwise it is the frequency integral.</p><p>To get the density/number of electrons, multiply the result of this integral by <code>n_sp/det(bz.B)</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/c1395c2eda11d0ef2851b003642910b6e3fc2126/src/apps.jl#L612-L627">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.AuxTransportDistributionIntegrand" href="#AutoBZ.AuxTransportDistributionIntegrand"><code>AutoBZ.AuxTransportDistributionIntegrand</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AuxTransportDistributionIntegrand(hv, [auxfun]; Σ, ω₁, ω₂, μ)</code></pre><p>A function whose integral over the BZ gives the transport distribution</p><p class="math-container">\[\Gamma_{\alpha\beta}(\omega_1, \omega_2) = \int_{\text{BZ}} dk \operatorname{Tr}[\nu_\alpha(k) A(k,\omega_1) \nu_\beta(k) A(k, \omega_2)]\]</p><p>Based on <a href="https://triqs.github.io/dft_tools/latest/guide/transport.html">TRIQS</a>. See <code>Integrand</code> for more details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/c1395c2eda11d0ef2851b003642910b6e3fc2126/src/apps.jl#L778-L787">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.AuxKineticCoefficientIntegrand" href="#AutoBZ.AuxKineticCoefficientIntegrand"><code>AutoBZ.AuxKineticCoefficientIntegrand</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AuxKineticCoefficientIntegrand</code></pre><p>A kinetic coefficient integrand that is more robust to the peak-missing problem. See <a href="#AutoBZ.KineticCoefficientIntegrand"><code>KineticCoefficientIntegrand</code></a> for arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/c1395c2eda11d0ef2851b003642910b6e3fc2126/src/apps.jl#L819-L824">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.AuxOpticalConductivityIntegrand" href="#AutoBZ.AuxOpticalConductivityIntegrand"><code>AutoBZ.AuxOpticalConductivityIntegrand</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AuxOpticalConductivityIntegrand</code></pre><p>Returns a <code>AuxKineticCoefficientIntegrand</code> with <code>n=0</code>. See <a href="#AutoBZ.AuxKineticCoefficientIntegrand"><code>AuxKineticCoefficientIntegrand</code></a> for further details</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/c1395c2eda11d0ef2851b003642910b6e3fc2126/src/apps.jl#L867-L872">source</a></section></article><h3 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.fermi" href="#AutoBZ.fermi"><code>AutoBZ.fermi</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">fermi(β, ω)
fermi(x)</code></pre><p>Evaluates a Fermi distribution with unitless input</p><p class="math-container">\[f(x) = \frac{1}{e^{x}+1}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/c1395c2eda11d0ef2851b003642910b6e3fc2126/src/fermi.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.fermi′" href="#AutoBZ.fermi′"><code>AutoBZ.fermi′</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">fermi′(x)</code></pre><p>Evaluates a first derivative of the Fermi distribution with unitless input</p><p class="math-container">\[\partial_{x} f(x) = -\frac{1}{2(\cosh(x)+1)}\]</p><p>Note that the analytic expression above can be rewritten many ways using hypertrigonometric identities.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/c1395c2eda11d0ef2851b003642910b6e3fc2126/src/fermi.jl#L21-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.fermi_window" href="#AutoBZ.fermi_window"><code>AutoBZ.fermi_window</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">fermi_window(β, ω, Ω)
fermi_window(x, y)</code></pre><p>Evaluates a unitless window function with unitless inputs determined by the Fermi distribution <span>$f$</span> and defined by</p><p class="math-container">\[\chi(x, y) = \frac{f(x) - f(x+y)}{y}\]</p><p>In the case <code>y==0</code> then this simplifies to the derivative of the Fermi distribution.</p><p>See also <a href="#AutoBZ.fermi"><code>fermi</code></a> and <a href="#AutoBZ.fermi′"><code>fermi′</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/c1395c2eda11d0ef2851b003642910b6e3fc2126/src/fermi.jl#L36-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.fermi_window_limits" href="#AutoBZ.fermi_window_limits"><code>AutoBZ.fermi_window_limits</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">fermi_window_limits(Ω, β [; atol=0.0, rtol=1e-20])</code></pre><p>Returns limits <code>(a,b)</code> over ω restricted to the interval where the Fermi window is larger than <code>max(atol,rtol*fermi_window(0,β*Ω))</code>. Choosing <code>atol</code> and <code>rtol</code> wisely is important to integrating the entire region of interest, since this is a truncation of an infinite interval, and should be tested for convergence.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/c1395c2eda11d0ef2851b003642910b6e3fc2126/src/fermi.jl#L98-L105">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../self_energy/">« Self energies</a><a class="docs-footer-nextpage" href="../interfaces/">Interfaces »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Saturday 4 May 2024 21:41">Saturday 4 May 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
