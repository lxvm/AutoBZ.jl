<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Self energies · AutoBZ.jl</title><meta name="title" content="Self energies · AutoBZ.jl"/><meta property="og:title" content="Self energies · AutoBZ.jl"/><meta property="twitter:title" content="Self energies · AutoBZ.jl"/><meta name="description" content="Documentation for AutoBZ.jl."/><meta property="og:description" content="Documentation for AutoBZ.jl."/><meta property="twitter:description" content="Documentation for AutoBZ.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">AutoBZ.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../workflow/">Getting started</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../demo/dos/">Density of states</a></li><li><a class="tocitem" href="../../demo/density/">Electron density</a></li><li><a class="tocitem" href="../../demo/oc/">Optical conductivity</a></li></ul></li><li><span class="tocitem">Visualization</span><ul><li><a class="tocitem" href="../../viz/band/">Band diagrams</a></li><li><a class="tocitem" href="../../viz/bz/">BZ visualization</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../man/fourier/">Fourier series</a></li><li class="is-active"><a class="tocitem" href>Self energies</a><ul class="internal"><li><a class="tocitem" href="#IO"><span>IO</span></a></li><li><a class="tocitem" href="#Interface"><span>Interface</span></a></li><li><a class="tocitem" href="#Types"><span>Types</span></a></li></ul></li><li><a class="tocitem" href="../integrands/">Integrands</a></li><li><a class="tocitem" href="../interfaces/">Interfaces</a></li><li><a class="tocitem" href="../../man/internal/">Internal</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Self energies</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Self energies</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/lxvm/AutoBZ.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/lxvm/AutoBZ.jl/blob/main/docs/src/pages/app/self_energy.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Self-energies"><a class="docs-heading-anchor" href="#Self-energies">Self energies</a><a id="Self-energies-1"></a><a class="docs-heading-anchor-permalink" href="#Self-energies" title="Permalink"></a></h1><p>This section of the documentation explains how scalar and matrix-valued self energy data are formatted, loaded, and evaluated. Self energies are interpolated efficiently during the evaluation of the Green&#39;s function using a fast-to-evaluate polynomial or rational representation of input data.</p><h2 id="IO"><a class="docs-heading-anchor" href="#IO">IO</a><a id="IO-1"></a><a class="docs-heading-anchor-permalink" href="#IO" title="Permalink"></a></h2><p>For self energy data stored on equispaced frequency grids, the following file formats and routines use the <code>EquiBaryInterp.jl</code> package to interpolate the data for continuous evaluation. Otherwise, a rational approximation of the self energy data is constructed with the AAA algorithm in <code>BaryRational.jl</code> and that is converted into a piecewise Chebyshev interpolant with <code>HChebInterp.jl</code>.</p><h3 id="File-format"><a class="docs-heading-anchor" href="#File-format">File format</a><a id="File-format-1"></a><a class="docs-heading-anchor-permalink" href="#File-format" title="Permalink"></a></h3><p>Depending on the amount of data necessary to represent the self-energy, there are different data file formats for scalar and matrix-valued self energies. Within matrix-valued self energies. There is also a special case for diagonal matrices.</p><h4 id="Scalar"><a class="docs-heading-anchor" href="#Scalar">Scalar</a><a id="Scalar-1"></a><a class="docs-heading-anchor-permalink" href="#Scalar" title="Permalink"></a></h4><p>First line contains only <code>nfpts</code>, the number of frequency points in the data set. The following <code>nfpts</code> lines contain three columns with the frequency point, real part of the self energy, and imaginary part of the self energy. For example</p><pre><code class="nohighlight hljs">3001
-15.00   7.9224534011421888  -0.0608455837453997
-14.99   7.9107083143558103  -0.0627222170930403
...</code></pre><h4 id="Diagonal"><a class="docs-heading-anchor" href="#Diagonal">Diagonal</a><a id="Diagonal-1"></a><a class="docs-heading-anchor-permalink" href="#Diagonal" title="Permalink"></a></h4><p>First line contains only <code>nfpts</code>, the number of frequency points in the data set. Second line contains only <code>num_wann</code>, the number of bands used for Wannier interpolation (i.e. should be the same as the Hamiltonian). The following <code>nfpts*num_wann</code> lines contain four columns with the frequency point, one-base index of the self energy in the diagonal of the matrix, real part of the self energy, and imaginary part of the self energy. It is assumed that the frequency data is sorted wih the index as the faster index than the frequency. For example</p><pre><code class="nohighlight hljs">3001
3
-15.00   1   7.9224534011421888  -0.0608455837453997
-15.00   2   7.9224534011422065  -0.0608455837453997
...</code></pre><h4 id="Matrix"><a class="docs-heading-anchor" href="#Matrix">Matrix</a><a id="Matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Matrix" title="Permalink"></a></h4><p>First line contains only <code>nfpts</code>, the number of frequency points in the data set. Second line contains only <code>num_wann</code>, the number of bands used for Wannier interpolation (i.e. should be the same as the Hamiltonian). The following <code>nfpts*num_wann^2</code> lines contain five columns with the frequency point, one-base index of the self energy in the row of the matrix, one-base index of the self energy in the column of the matrix, real part of the self energy, and imaginary part of the self energy. It is assumed that the frequency data is sorted wih the index as the faster index than the frequency. For example</p><pre><code class="nohighlight hljs">3001
3
-15.00   1   1   7.9224534011421888  -0.0608455837453997
-15.00   1   2   7.9224534011422065  -0.0608455837453997
...</code></pre><h3 id="Routines"><a class="docs-heading-anchor" href="#Routines">Routines</a><a id="Routines-1"></a><a class="docs-heading-anchor-permalink" href="#Routines" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.load_self_energy" href="#AutoBZ.load_self_energy"><code>AutoBZ.load_self_energy</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_self_energy(filename; [sigdigits=8, output=:interp, degree=:default])</code></pre><p>Read the self energy data in <code>filename</code>, which should be in either <code>:scalar</code>, <code>:diagonal</code>, or <code>:matrix</code> format, and return a self-energy evaluator. Note that the frequency data is assumed to be an equispace grid. The optional argument <code>degree</code> indicates the degree of barycentric Lagrange interpolation, and that <code>sigdigits</code> indicates the number of significant digits used to round the frequency data so as to avoid rounding errors.</p><p>The keyword <code>output</code> may take values of <code>:interp</code> (default) or <code>:raw</code> which will either return the self energy data wrapped with a high-order interpolating function (details below) or in the latter option, just the raw data.</p><p>The interpolating function will always be a piecewise high-order polynomial whose details depend on the distribution of frequency points:</p><ul><li>For equispaced frequency points, a local barycentric Lagrange interpolant is used with a default polynomial degree of 8</li><li>For other frequency point distributions, first a global rational approximant is formed using the <a href="https://arxiv.org/abs/1612.00337">AAA algorithm</a>, and then h-adaptive Chebyshev interpolation is performed on the global interpolant in order to obtain a fast-to-evaluate representation of default polynomial degree 16.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/4ac90310b9fe81e0ae283c773e0a96a0d9f69df4/src/self_energies_io.jl#L76-L99">source</a></section></article><h2 id="Interface"><a class="docs-heading-anchor" href="#Interface">Interface</a><a id="Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Interface" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.AbstractSelfEnergy" href="#AutoBZ.AbstractSelfEnergy"><code>AutoBZ.AbstractSelfEnergy</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractSelfEnergy</code></pre><p>An abstract type whose instances implement the following interface:</p><ul><li>instances are callable and return a square matrix as a function of frequency</li><li>instances have methods <code>lb</code> and <code>ub</code> that return the lower and upper bounds of of the frequency domain for which the instance can be evaluated</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/4ac90310b9fe81e0ae283c773e0a96a0d9f69df4/src/definitions.jl#L11-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.lb" href="#AutoBZ.lb"><code>AutoBZ.lb</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">lb(::AbstractSelfEnergy)</code></pre><p>Return the greatest lower bound of the domain of the self energy evaluator</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/4ac90310b9fe81e0ae283c773e0a96a0d9f69df4/src/definitions.jl#L21-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.ub" href="#AutoBZ.ub"><code>AutoBZ.ub</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ub(::AbstractSelfEnergy)</code></pre><p>Return the least upper bound of the domain of the self energy evaluator</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/4ac90310b9fe81e0ae283c773e0a96a0d9f69df4/src/definitions.jl#L29-L33">source</a></section></article><h2 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.EtaSelfEnergy" href="#AutoBZ.EtaSelfEnergy"><code>AutoBZ.EtaSelfEnergy</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EtaSelfEnergy(η::Number)</code></pre><p>Construct a <a href="#AutoBZ.ConstScalarSelfEnergy"><code>ConstScalarSelfEnergy</code></a> with value <code>-im*η</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/4ac90310b9fe81e0ae283c773e0a96a0d9f69df4/src/self_energies.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.ConstScalarSelfEnergy" href="#AutoBZ.ConstScalarSelfEnergy"><code>AutoBZ.ConstScalarSelfEnergy</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ConstScalarSelfEnergy(v::Number)</code></pre><p>Construct a self-energy evaluator which returns <span>$v I$</span> for any frequency.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/4ac90310b9fe81e0ae283c773e0a96a0d9f69df4/src/self_energies.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.ScalarSelfEnergy" href="#AutoBZ.ScalarSelfEnergy"><code>AutoBZ.ScalarSelfEnergy</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ScalarSelfEnergy(interpolant, lb, ub)</code></pre><p>Construct a self-energy evaluator which for frequencies above <code>lb</code> and below <code>ub</code> returns the scalar interpolant at that frequency times an identity matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/4ac90310b9fe81e0ae283c773e0a96a0d9f69df4/src/self_energies.jl#L26-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.DiagonalSelfEnergy" href="#AutoBZ.DiagonalSelfEnergy"><code>AutoBZ.DiagonalSelfEnergy</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DiagonalSelfEnergy(interpolant, lb, ub)</code></pre><p>Construct a self-energy evaluator which for frequencies above <code>lb</code> and below <code>ub</code> returns the vector interpolant at that frequency wrapped by a <code>Diagonal</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/4ac90310b9fe81e0ae283c773e0a96a0d9f69df4/src/self_energies.jl#L42-L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoBZ.MatrixSelfEnergy" href="#AutoBZ.MatrixSelfEnergy"><code>AutoBZ.MatrixSelfEnergy</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MatrixSelfEnergy(interpolant, lb, ub)</code></pre><p>Construct a self-energy evaluator which for frequencies above <code>lb</code> and below <code>ub</code> returns the matrix-valued interpolant at that frequency.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lxvm/AutoBZ.jl/blob/4ac90310b9fe81e0ae283c773e0a96a0d9f69df4/src/self_energies.jl#L58-L63">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../man/fourier/">« Fourier series</a><a class="docs-footer-nextpage" href="../integrands/">Integrands »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Sunday 20 October 2024 18:01">Sunday 20 October 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
